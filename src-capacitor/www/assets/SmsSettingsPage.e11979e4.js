import{u as Z}from"./quasar.esm.prod.7cf60e50.js";import{u as u4}from"./sms.44f4b116.js";import{u as e4}from"./popup.f1b7e5e0.js";import{u as t4}from"./toasts.113f48d8.js";import{_ as w}from"./Section.3899c609.js";import{a4 as Q,aG as d,ay as x,W as O,a2 as u,b1 as e,X as s4,a1 as r,D as B,U as G,aF as n4,V as i4,r as a4,k as o4,as as r4,Q as M,x as i,I as l4}from"./index.53588f62.js";import{_ as m4}from"./InfoPanel.49feab07.js";import{e as V,f as L,g as c4}from"./base.686dbe64.js";import{S as d4}from"./time.50f2cb44.js";import{f as W}from"./money.dd3f296a.js";import{f as p4}from"./date-time.d466b3fd.js";import{b as _4,a as J}from"./isObjectLike.0d538a5a.js";import{i as f4}from"./isSymbol.03012f90.js";import{m as Y}from"./time.8571a5e6.js";import{api as $,apiClient as g4}from"./api.50e126cb.js";import"./isTomorrow.a3ceb101.js";import"./_commonjsHelpers.2cf1d77b.js";import"./dayjs.228bf609.js";const S4={class:"settings-page-sms-template"},v4={class:"settings-page-sms-template__header"},D4=r(" \u041F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F "),E4=r(" \u0429\u043E\u0439\u043D\u043E "),T4=r(" Pullcrm "),j=Q({name:"SmsTemplate",props:{template:{type:String,required:!0}},setup(t){return(s,p)=>{const _=d("UiIcon"),l=d("UiText"),g=d("UiPanel");return x(),O("div",S4,[u(g,{size:"s",responsive:"",class:"settings-page-sms-template__inner"},{default:e(()=>[s4("div",v4,[u(l,{size:"l",responsive:"",class:"settings-page-sms-template__text_1"},{prepend:e(()=>[u(_,{size:"xs",name:"solid/chat-circle-dots-fill"})]),default:e(()=>[D4]),_:1}),u(l,{size:"m",responsive:"",class:"settings-page-sms-template__text_2"},{default:e(()=>[E4]),_:1})]),u(l,{size:"l",strong:"",class:"settings-page-sms-template__title"},{default:e(()=>[T4]),_:1}),u(l,{size:"m",responsive:""},{default:e(()=>[r(B(t.template),1)]),_:1})]),_:1}),s.$slots.disclaimer?(x(),G(l,{key:0,size:"m",responsive:"",class:"settings-page-sms-template__disclaimer"},{default:e(()=>[n4(s.$slots,"disclaimer")]),_:3})):i4("",!0)])}}});var F4=_4,C4=function(){return F4.Date.now()},h4=C4,M4=/\s/;function b4(t){for(var s=t.length;s--&&M4.test(t.charAt(s)););return s}var U4=b4,y4=U4,A4=/^\s+/;function I4(t){return t&&t.slice(0,y4(t)+1).replace(A4,"")}var B4=I4,x4=B4,q=J,z4=f4,X=0/0,k4=/^[-+]0x[0-9a-f]+$/i,w4=/^0b[01]+$/i,N4=/^0o[0-7]+$/i,$4=parseInt;function P4(t){if(typeof t=="number")return t;if(z4(t))return X;if(q(t)){var s=typeof t.valueOf=="function"?t.valueOf():t;t=q(s)?s+"":s}if(typeof t!="string")return t===0?t:+t;t=x4(t);var p=w4.test(t);return p||N4.test(t)?$4(t.slice(2),p?2:8):k4.test(t)?X:+t}var O4=P4,R4=J,P=h4,H=O4,V4="Expected a function",L4=Math.max,W4=Math.min;function Y4(t,s,p){var _,l,g,a,m,D,F=0,z=!1,E=!1,U=!0;if(typeof t!="function")throw new TypeError(V4);s=H(s)||0,R4(p)&&(z=!!p.leading,E="maxWait"in p,g=E?L4(H(p.maxWait)||0,s):g,U="trailing"in p?!!p.trailing:U);function y(n){var v=_,h=l;return _=l=void 0,F=n,a=t.apply(h,v),a}function N(n){return F=n,m=setTimeout(o,s),z?y(n):a}function A(n){var v=n-D,h=n-F,k=s-v;return E?W4(k,g-h):k}function f(n){var v=n-D,h=n-F;return D===void 0||v>=s||v<0||E&&h>=g}function o(){var n=P();if(f(n))return C(n);m=setTimeout(o,A(n))}function C(n){return m=void 0,U&&_?y(n):(_=l=void 0,a)}function S(){m!==void 0&&clearTimeout(m),F=0,_=D=l=m=void 0}function T(){return m===void 0?a:C(P())}function b(){var n=P(),v=f(n);if(_=arguments,l=this,D=n,v){if(m===void 0)return N(D);if(E)return clearTimeout(m),m=setTimeout(o,s),y(D)}return m===void 0&&(m=setTimeout(o,s)),a}return b.cancel=S,b.flush=T,b}var j4=Y4;const q4={class:"sms-settings-page"},X4=r(" \u0414\u043B\u044F \u0437\u043C\u0456\u043D\u0438\u0442\u0438 \u0442\u0435\u043A\u0441\u0442\u0443 \u0448\u0430\u0431\u043B\u043E\u043D\u0443 \u0421\u041C\u0421 \u0437\u0432\u0435\u0440\u043D\u0456\u0442\u044C\u0441\u044F \u0432 \u0442\u0435\u0445\u043D\u0456\u0447\u043D\u0443 \u043F\u0456\u0434\u0442\u0440\u0438\u043C\u043A\u0443 "),H4=r(" \u0411\u0430\u043B\u0430\u043D\u0441 "),Q4=r(" \u041F\u043E\u043F\u043E\u0432\u043D\u0438\u0442\u0438 \u0431\u0430\u043B\u0430\u043D\u0441 "),G4=r(" \u0406\u0441\u0442\u043E\u0440\u0456\u044F \u043F\u043E\u043F\u043E\u0432\u043D\u0435\u043D\u044C "),J4=r(" \u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F \u0421\u041C\u0421 "),K4=r(" \u0423\u0432\u0435\u0434\u043E\u043C\u043B\u044F\u0442\u044C \u0437\u0430: "),Z4=r(" \u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F \u0421\u041C\u0421 "),uu=r(" \u0410\u043A\u0442\u0438\u0432\u0443\u0432\u0430\u0442\u0438 "),Du=Q({name:"SmsSettingsPage",setup(t){Z({title:"\u041D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F \u0421\u041C\u0421 - pullcrm"});const s=u4(),p=e4(),_=t4();let l=a4([]);const g=o4(!1);r4(async()=>{const{data:f}=await $.balance.history({offset:0,limit:20});l=f});const a=M(()=>s.settings),m=M(()=>s.balance),D=M(()=>s.isAuthorize),F=M(()=>a.value.remindSMSTemplate||V),z=M(()=>a.value.creationSMSTemplate||L),E=M(()=>({name:Y(a.value.remindSMSMinutes),value:a.value.remindSMSMinutes})),U=M(()=>d4.map(f=>({name:Y(f),value:f})));async function y(){const{MINIMUM_DEPOSIT_AMOUNT:f,MAXIMUM_DEPOSIT_AMOUNT:o}=process.env,C=await p.askQuestion({title:"\u0412\u043A\u0430\u0436\u0456\u0442\u044C \u0441\u0443\u043C\u0443 \u0434\u043B\u044F \u043F\u043E\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F",input:{type:"number",value:f,min:f,max:o},acceptButtonTitle:"\u041F\u043E\u043F\u043E\u0432\u043D\u0438\u0442\u0438"});if(C){const S=await g4.balanceCheckout({amount:Number(C)}),T=window.open();T.document.body.innerHTML=S,T.document.body.querySelector("form").submit()}}async function N(){try{g.value=!0,await $.sms.settingCreate({hasRemindSMS:!0,hasCreationSMS:!1,remindSMSMinutes:60,remindSMSTemplate:V,creationSMSTemplate:L}),window.location.reload()}catch{_.show({type:"error",title:"\u0429\u043E\u0441\u044C \u043D\u0435 \u0442\u0430\u043A!"})}finally{g.value=!1}}const A=j4(async()=>{try{await $.sms.settingUpdate(c4(a.value))}catch{_.show({type:"error",title:"\u0429\u043E\u0441\u044C \u043D\u0435 \u0442\u0430\u043A!"})}},200);return(f,o)=>{const C=d("UiAlert"),S=d("UiText"),T=d("UiTitle"),b=d("UiButton"),n=d("UiTableColumn"),v=d("UiTable"),h=d("UiAccordionItem"),k=d("UiAccordion"),I=d("UiPanel"),R=d("UiSwitch"),K=d("UiSelect");return x(),O("div",q4,[i(D)?(x(),O(l4,{key:0},[u(C,{type:"info","left-icon":"outlined/warning-circle",class:"sms-settings-page__alert"},{default:e(()=>[X4]),_:1}),u(m4,{class:"sms-settings-page__balance",icon:"outlined/wallet",theme:"green"},{append:e(()=>[u(b,{size:"m",theme:"blue",responsive:"",onClick:y},{default:e(()=>[Q4]),_:1})]),default:e(()=>[u(S,{size:"m",responsive:""},{default:e(()=>[H4]),_:1}),u(T,{size:"s",responsive:""},{default:e(()=>[r(B(i(W)(i(m))),1)]),_:1})]),_:1}),u(I,{size:"m",responsive:""},{default:e(()=>[u(k,{class:"sms-settings-page__accordion"},{default:e(()=>[u(h,{name:"history"},{toggle:e(()=>[u(S,{size:"l",strong:"",responsive:""},{default:e(()=>[G4]),_:1})]),default:e(()=>[u(v,{data:i(l),numbered:""},{default:e(({row:c})=>[u(n,{name:"\u0414\u0430\u0442\u0430 \u043F\u043E\u043F\u043E\u0432\u043D\u0435\u043D\u043D\u044F",align:"left"},{default:e(()=>[u(S,{size:"m",responsive:""},{default:e(()=>[r(B(i(p4)(c.createdAt,"DD.MM.YYYY")),1)]),_:2},1024)]),_:2},1024),u(n,{name:"\u0426\u0456\u043D\u0430",align:"right"},{default:e(()=>[u(S,{size:"m",responsive:""},{default:e(()=>[r(B(i(W)(c.amount)),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data"])]),_:1})]),_:1})]),_:1}),u(I,{size:"m",responsive:""},{default:e(()=>[u(T,{size:"s",responsive:"",class:"sms-settings-page__title"},{default:e(()=>[J4]),_:1}),u(w,{title:"\u0412\u0438 \u0430\u0432\u0442\u043E\u0440\u0438\u0437\u043E\u0432\u0430\u043D\u0456 \u0432 \u0421\u041C\u0421-\u0441\u0435\u0440\u0432\u0456\u0441\u0456","sub-title":"\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u0456 \u0444\u0443\u043D\u043A\u0446\u0456\u0457 \u043D\u0430\u0434\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0430\u043C \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u044C \u043F\u0440\u043E \u0441\u0442\u0430\u0442\u0443\u0441\u0438 \u0437\u0430\u043F\u0438\u0441\u0456\u0432"})]),_:1}),u(I,{size:"m",responsive:""},{default:e(()=>[u(w,{title:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u0438\u0442\u0438 \u043A\u043B\u0456\u0454\u043D\u0442\u0430 \u043F\u0456\u0441\u043B\u044F \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0437\u0430\u043F\u0438\u0441\u0443","sub-title":"\u0421\u041C\u0421 \u0432\u0456\u0434\u043F\u0440\u0430\u0432\u0438\u0442\u044C\u0441\u044F \u0447\u0435\u0440\u0435\u0437 2 \u0445\u0432\u0438\u043B\u0438\u043D\u0438 \u043F\u0456\u0441\u043B\u044F \u0441\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u0437\u0430\u043F\u0438\u0441\u0443"},{append:e(()=>[u(R,{modelValue:i(a).hasCreationSMS,"onUpdate:modelValue":o[0]||(o[0]=c=>i(a).hasCreationSMS=c),size:"m",onInput:i(A)},null,8,["modelValue","onInput"])]),_:1}),u(j,{class:"sms-settings-page__sms-template",template:i(z),"onUpdate:template":o[1]||(o[1]=c=>i(a).creationSMSTemplate=c)},null,8,["template"])]),_:1}),u(I,{size:"m",responsive:""},{default:e(()=>[u(w,{title:"\u041F\u043E\u0432\u0456\u0434\u043E\u043C\u0438\u0442\u0438 \u043A\u043B\u0456\u0454\u043D\u0442\u0430 \u043F\u0435\u0440\u0435\u0434 \u0437\u0430\u043F\u0438\u0441\u043E\u043C"},{append:e(()=>[u(R,{modelValue:i(a).hasRemindSMS,"onUpdate:modelValue":o[2]||(o[2]=c=>i(a).hasRemindSMS=c),size:"m",onInput:i(A)},null,8,["modelValue","onInput"])]),_:1}),u(S,{class:"sms-settings-page__notify-selector",size:"l",responsive:""},{append:e(()=>[u(K,{"label-key":"name",options:i(U),required:"",clearable:!1,placeholder:"\u0412\u0438\u0431\u0440\u0430\u0442\u0438 \u0447\u0430\u0441","model-value":i(E),"onUpdate:modelValue":o[3]||(o[3]=c=>{i(a).remindSMSMinutes=c.value,i(A)()})},{input:e(({onFocus:c})=>[u(S,{size:"m",responsive:"","right-icon":"outlined/caret-down",onClick:c},{default:e(()=>[r(B(i(E).name)+" \u0434\u043E \u043F\u043E\u0447\u0430\u0442\u043A\u0443 ",1)]),_:2},1032,["onClick"])]),_:1},8,["options","model-value"])]),default:e(()=>[K4]),_:1}),u(j,{class:"sms-settings-page__sms-template",template:i(F),"onUpdate:template":o[4]||(o[4]=c=>i(a).remindSMSTemplate=c)},null,8,["template"])]),_:1})],64)):(x(),G(I,{key:1,size:"m",responsive:""},{default:e(()=>[u(T,{size:"s",responsive:"",class:"sms-settings-page__title"},{default:e(()=>[Z4]),_:1}),u(w,{title:"\u0410\u0432\u0442\u043E\u0440\u0438\u0437\u0430\u0446\u0456\u044F \u0432 \u0421\u041C\u0421-\u0441\u0435\u0440\u0432\u0456\u0441\u0456","sub-title":"\u0410\u043A\u0442\u0438\u0432\u0443\u0439\u0442\u0435 \u0444\u0443\u043D\u043A\u0446\u0456\u044E \u043D\u0430\u0434\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u043A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447\u0430\u043C \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u044C \u043F\u0440\u043E \u043C\u0430\u0439\u0431\u0443\u0442\u043D\u0456 \u0437\u0430\u043F\u0438\u0441\u0438"},{append:e(()=>[u(b,{size:"s",theme:"blue",loading:g.value,onClick:N},{default:e(()=>[uu]),_:1},8,["loading"])]),_:1})]),_:1}))])}}});export{Du as default};
