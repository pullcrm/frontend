var k=Object.defineProperty;var h=Object.getOwnPropertySymbols;var g=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var B=(o,e,u)=>e in o?k(o,e,{enumerable:!0,configurable:!0,writable:!0,value:u}):o[e]=u,n=(o,e)=>{for(var u in e||(e={}))g.call(e,u)&&B(o,u,e[u]);if(h)for(var u of h(e))x.call(e,u)&&B(o,u,e[u]);return o};import{a4 as I,bw as A,bD as $,r as N,k as T,Q as M,aG as d,ay as R,U as L,b1 as i,X as q,a2 as s,x as l,bp as z,a1 as G}from"./index.90ead00b.js";import{u as Q}from"./quasar.esm.prod.c88b943c.js";import{u as X,a as j,b as H}from"./base.bf638541.js";import{u as J}from"./toasts.5fba8d07.js";import{b as K,V,c as O,u as W}from"./index.a16d5f6b.js";import{_ as Y}from"./Layout.450cccb5.js";import{api as Z}from"./api.9988d825.js";import"./logo.0179c6cf.js";import"./_commonjsHelpers.2cf1d77b.js";const u4=["onSubmit"],e4=G(" \u041F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0438 "),m4=I({setup(o){Q({title:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044F \u0440\u0435\u0454\u0441\u0442\u0440\u0430\u0446\u0456\u0457 - pullcrm"});const e=A(),u=$(),c=X(),b=j(),f=J(),_=H(),a=N({password:"",repeatPassword:""}),m=T(!1),v=M(()=>String(e.params.slug)),D={password:n(n({},K("\u041C\u0456\u043D\u0456\u043C\u0430\u043B\u044C\u043D\u0430 \u043A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432: 4",4)),V("\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043F\u0430\u0440\u043E\u043B\u044C")),repeatPassword:n(n({},V("\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E \u043D\u043E\u0432\u0438\u0439 \u043F\u0430\u0440\u043E\u043B\u044C")),O("\u041F\u0430\u0440\u043E\u043B\u0456 \u043D\u0435 \u0441\u043F\u0456\u0432\u043F\u0430\u0434\u0430\u044E\u0442\u044C",a.password))},w=W(D,a);async function y(){if(!!await w.$validate())try{m.value=!0;const t=await Z.profile.confirm({token:v.value,password:a.password});if(await c.saveTokens(t),await b.fetchProfile(),_.hasPositions){const p=_.positions[0];await c.refreshTokenByPosition(p),u.push({name:"dashboard"});return}await u.push({name:"companyCreate"})}catch(t){if(t.fieldName==="code"){f.show({title:t.message,type:"error"});return}if(t.status===404){f.show({title:"\u041A\u043E\u0440\u0438\u0441\u0442\u0443\u0432\u0430\u0447 \u043D\u0435 \u0437\u043D\u0430\u0439\u0434\u0435\u043D\u0438\u0439",type:"error"});return}throw t}finally{m.value=!1}}return(S,t)=>{const p=d("UiInput"),C=d("UiField"),P=d("UiButton"),U=d("UiFormValidator");return R(),L(Y,{title:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044F \u0440\u0435\u0454\u0441\u0442\u0440\u0430\u0446\u0456\u0457","sub-title":"\u041F\u0440\u0438\u0434\u0443\u043C\u0430\u0439\u0442\u0435 \u043F\u0430\u0440\u043E\u043B\u044C \u0434\u043B\u044F \u0432\u0445\u043E\u0434\u0443",class:"auth-confirmation"},{default:i(()=>[q("form",{onSubmit:z(y,["prevent"])},[s(U,{validate:l(w)},{default:i(({resetFieldError:E,getFieldError:F})=>[s(C,{label:"\u041F\u0430\u0440\u043E\u043B\u044C",error:F("password")},{default:i(()=>[s(p,{modelValue:l(a).password,"onUpdate:modelValue":t[0]||(t[0]=r=>l(a).password=r),"left-icon":"outlined/key",name:"password",type:"password",placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043D\u043E\u0432\u0438\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",onInput:r=>E("password")},null,8,["modelValue","onInput"])]),_:2},1032,["error"]),s(C,{label:"\u041F\u043E\u0432\u0442\u043E\u0440\u0456\u0442\u044C \u043F\u0430\u0440\u043E\u043B\u044C",error:F("repeatPassword")},{default:i(()=>[s(p,{modelValue:l(a).repeatPassword,"onUpdate:modelValue":t[1]||(t[1]=r=>l(a).repeatPassword=r),"left-icon":"outlined/key",name:"repeatPassword",type:"password",placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E \u043D\u043E\u0432\u0438\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",onInput:r=>E("repeatPassword")},null,8,["modelValue","onInput"])]),_:2},1032,["error"]),s(P,{class:"auth-confirmation__button",type:"submit",size:"l",theme:"blue",loading:m.value},{default:i(()=>[e4]),_:1},8,["loading"])]),_:1},8,["validate"])],40,u4)]),_:1})}}});export{m4 as default};
