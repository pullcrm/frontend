import{u as x}from"./quasar.esm.prod.7cf60e50.js";import{u as k,C as A,a as T}from"./schedule.da7e5da2.js";import{u as V}from"./specialist.8713490f.js";import{f as U}from"./date-time.d466b3fd.js";import{p as z}from"./time.8571a5e6.js";import{f as $}from"./money.dd3f296a.js";import"./dayjs.228bf609.js";import{_ as b}from"./DatePicker.06e76f12.js";import{a4 as M,Q as s,aG as C,ay as d,W as w,X as f,a2 as l,b1 as p,x as e,f as E,a1 as m,D as _,U as S,k as P,aA as L,as as N,V as O}from"./index.53588f62.js";import{d as D}from"./isTomorrow.a3ceb101.js";import{S as Y}from"./Loader.55629d1d.js";import{a as H,b as j}from"./Column.04cdc3e6.js";import"./base.686dbe64.js";import"./_commonjsHelpers.2cf1d77b.js";import"./timetable.70b57e2e.js";import"./popup.f1b7e5e0.js";import"./toasts.113f48d8.js";import"./index.ca9f222c.js";import"./api.50e126cb.js";const F={class:"specialist-schedule-page-header"},G={class:"specialist-schedule-page-header__left"},Q=m(" \u0417\u0430\u0432\u0442\u0440\u0430 "),R=m(" \u0421\u044C\u043E\u0433\u043E\u0434\u043D\u0456 "),W={class:"specialist-schedule-page-header__right"},X=f("span",null," - ",-1),q=M({name:"Header",props:{appointments:{type:Array,default:()=>[]}},setup(B){const c=B,n=k(),a=s({get(){return new Date(n.date)},set(o){const t=D(o).format("YYYY-MM-DD");n.date=t,n.fetch()}}),h=s(()=>D(a.value).isToday()),i=s(()=>c.appointments.length),v=s(()=>c.appointments.filter(({status:o})=>o===A).reduce((o,{total:t})=>o+t,0));function g(){a.value=D(new Date).add(1,"day").toDate()}return(o,t)=>{const u=C("UiButton"),r=C("UiPopover");return d(),w("div",F,[f("div",G,[l(r,{size:"m",placement:"bottom_start"},{body:p(()=>[l(b,{modelValue:e(a),"onUpdate:modelValue":t[0]||(t[0]=y=>E(a)?a.value=y:null)},null,8,["modelValue"])]),default:p(()=>[l(u,{class:"specialist-schedule-page-header__calendar",size:"m",theme:"transparent","left-icon":"outlined/calendar","right-icon":"solid/caret-down-fill"},{default:p(()=>[m(_(e(U)(e(a),"D MMMM, dd")),1)]),_:1})]),_:1}),e(h)?(d(),S(u,{key:0,class:"specialist-schedule-page-header__tomorrow",size:"m",theme:"transparent",onClick:g},{default:p(()=>[Q]),_:1})):(d(),S(u,{key:1,class:"specialist-schedule-page-header__today",size:"m",theme:"transparent",onClick:t[1]||(t[1]=y=>a.value=new Date)},{default:p(()=>[R]),_:1}))]),f("div",W,[m(_(e(i))+" "+_(e(z)(e(i),"\u043A\u043B\u0456\u0454\u043D\u0442","\u043A\u043B\u0456\u0454\u043D\u0442\u0430","\u043A\u043B\u0456\u0454\u043D\u0442\u0456\u0432"))+" ",1),X,m(" "+_(e($)(e(v))),1)])])}}});const I={class:"specialist-schedule-page"},he=M({name:"SchedulePage",setup(B){x({title:"\u041A\u0430\u043B\u0435\u043D\u0434\u0430\u0440 \u0441\u043F\u0435\u0446\u0456\u0430\u043B\u0456\u0441\u0442\u0430 - pullcrm"});const c=P(null),n=k(),a=V(),h=T();L("getUiTooltipContainer",()=>c.value);const i=s(()=>a.specialist),v=s(()=>n.isLoading),g=s(()=>n.normalizeTimeOffs),o=s(()=>h.appointments),t=s(()=>g.value.filter(({specialistId:r})=>r===i.value.id)),u=s(()=>o.value.filter(r=>r.specialist.id===i.value.id));return N(async()=>{await n.fetch}),(r,y)=>(d(),w("div",I,[l(q,{appointments:e(u)},null,8,["appointments"]),f("div",{ref_key:"inner",ref:c,class:"specialist-schedule-page__schedule"},[e(v)?(d(),S(Y,{key:0})):O("",!0),l(H,{class:"specialist-schedule-page__timeline"}),l(j,{class:"specialist-schedule-page__column","time-offs":e(t),specialist:e(i),appointments:e(u)},null,8,["time-offs","specialist","appointments"])],512)]))}});export{he as default};
