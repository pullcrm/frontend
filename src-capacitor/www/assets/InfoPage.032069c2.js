import{a4 as B,Q as p,aG as y,ay as D,W as A,I as z,aE as T,A as N,x as a,a2 as u,X as S,b1 as l,a1 as b,D as q,bD as M,k as P,bp as I}from"./index.53588f62.js";import{u as L}from"./quasar.esm.prod.7cf60e50.js";import{u as V}from"./toasts.113f48d8.js";import{b as Y}from"./base.686dbe64.js";import{A as k,u as R}from"./specialist.8713490f.js";import{u as O}from"./specialists.56f430f2.js";import{_ as W}from"./FileUpload.8d271c57.js";import{api as C}from"./api.50e126cb.js";import{f as j}from"./date-time.d466b3fd.js";import"./roles.61f7d6b9.js";import"./_commonjsHelpers.2cf1d77b.js";import"./isTomorrow.a3ceb101.js";const G={class:"specialist-about-page-avatars"},H=["onClick"],Q={class:"specialist-about-page-avatars__image"},X=B({name:"Avatars",props:{avatars:{type:Array,default:()=>[]},specialist:{type:Object,required:!0}},emits:["refresh"],setup(h,{emit:s}){const n=h,d=V(),r=O(),g=p(()=>n.specialist.user),x=p(()=>[...n.avatars].reverse()),e=p(()=>g.value.avatarId);async function U(m){try{if(!m)return;if(n.avatars.length>5){d.show({type:"error",title:"\u041F\u0435\u0440\u0435\u0432\u0438\u0449\u0435\u043D\u043E \u043B\u0456\u043C\u0456\u0442 \u0437\u0430\u0432\u0430\u043D\u0442\u0430\u0436\u0435\u043D\u043D\u044F \u0430\u0432\u0430\u0442\u0430\u0440\u043E\u043A"});return}const i=new FormData;i.append("files",m),i.append("group",k),i.append("userId",g.value.id);const[o]=await r.onUploadAvatar(i);o!=null&&o.id&&(await F(o.id),window.location.reload())}catch(i){if(i.status===413){d.show({type:"error",title:"\u0424\u0430\u0439\u043B \u0437\u0430\u043D\u0430\u0434\u0442\u043E \u0432\u0435\u043B\u0438\u043A\u0438\u0439, \u0441\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0432 \u0456\u043D\u0448\u043E\u043C\u0443 \u0440\u043E\u0437\u043C\u0456\u0440\u0456"});return}throw i}}async function F(m){await C.specialist.update({id:n.specialist.id,avatarId:m}),d.show({title:"\u0412\u0441\u0442\u0430\u043D\u043E\u0432\u043B\u0435\u043D\u043E \u043D\u043E\u0432\u0438\u0439 \u0430\u0432\u0430\u0442\u0430\u0440"}),s("refresh")}return(m,i)=>{const o=y("UiAvatar");return D(),A("div",G,[(D(!0),A(z,null,T(a(x),E=>(D(),A("div",{key:E.id,class:N(["specialist-about-page-avatars__image",{_active:a(e)===E.id}]),onClick:c=>F(E.id)},[u(o,{size:"l",image:E.path},null,8,["image"])],10,H))),128)),S("div",Q,[u(W,{onInput:U},{default:l(()=>[u(o,{size:"l",icon:"outlined/plus"})]),_:1})])])}}});const J={class:"specialist-info-page-created-at"},K={class:"specialist-info-page-created-at__text"},Z=b(" \u0414\u043E\u0434\u0430\u043D\u0438\u0439 \u0434\u043E \u043A\u043E\u043C\u043F\u0430\u043D\u0456\u0457 "),uu=B({name:"CreatedAt",props:{createdAt:{type:String,required:!0}},setup(h){return(s,n)=>{const d=y("UiIcon"),r=y("UiText");return D(),A("div",J,[u(d,{size:"l",name:"solid/user-circle-plus-fill"}),S("div",K,[u(r,{size:"m",responsive:""},{default:l(()=>[Z]),_:1}),u(r,{size:"l",responsive:""},{default:l(()=>[b(q(a(j)(h.createdAt,"D MMMM, YYYY")),1)]),_:1})])])}}});function eu(h){const s=document.createElement("textarea");s.value=h,s.style.position="absolute",s.style.left="-99999px",document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s)}const tu={class:"specialist-info-page"},au=["onSubmit"],su=b(" \u041F\u0435\u0440\u0441\u043E\u043D\u0430\u043B\u044C\u043D\u0435 \u043F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u043D\u0430 \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0443 \u0437\u0430\u043F\u0438\u0441\u0443 "),iu=b(" \u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 "),hu=B({name:"InfoPage",setup(h){L({title:"\u0418\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0456\u044F \u043F\u0440\u043E \u0441\u043F\u0435\u0446\u0456\u0430\u043B\u0456\u0441\u0442\u0430 - pullcrm"});const s=M(),n=V(),d=Y(),r=R(),g=P(!1),x=p(()=>r.avatars),e=p(()=>r.specialist),U=p(()=>d.companyId),F=p(()=>e.value.id),m=p(()=>e.value.user);async function i(){try{g.value=!0;const{id:c,user:t,status:_,description:f,specialization:w}=e.value;await C.specialist.update({id:c,email:t.email||void 0,status:_,fullName:t.fullName,description:f,specialization:w}),n.show({title:"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043E!"}),o()}catch(c){n.show({title:`\u041F\u043E\u043C\u0438\u043B\u043A\u0430: ${c.data.message}`,type:"error"})}finally{g.value=!1}}async function o(){const[c,t]=await Promise.all([C.files.all(m.value.id,{group:k}),C.specialist.get(F.value)]);r.avatars=c,r.specialist=t}async function E(){const{href:c}=s.resolve({name:"fullWidgetSpecialistPage",query:{companyId:U.value,specialistId:F.value}}),{BASE_HOST:t}=process.env;eu(`https://${t}${c}`),await n.show({title:"\u041F\u043E\u0441\u0438\u043B\u0430\u043D\u043D\u044F \u0441\u043A\u043E\u043F\u0456\u0439\u043E\u0432\u0430\u043D\u043E"})}return(c,t)=>{const _=y("UiInput"),f=y("UiField"),w=y("UiLink"),$=y("UiButton");return D(),A("div",tu,[u(X,{class:"specialist-info-page__avatars",avatars:a(x),specialist:a(e),onRefresh:o},null,8,["avatars","specialist"]),S("form",{onSubmit:I(i,["prevent"])},[u(f,{label:"\u0406\u043C'\u044F \u0442\u0430 \u041F\u0440\u0456\u0437\u0432\u0438\u0449\u0435",required:""},{default:l(()=>[u(_,{modelValue:a(e).user.fullName,"onUpdate:modelValue":t[0]||(t[0]=v=>a(e).user.fullName=v),name:"name",placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u0406\u043C'\u044F \u0442\u0430 \u041F\u0440\u0456\u0437\u0432\u0438\u0449\u0435",required:""},null,8,["modelValue"])]),_:1}),u(f,{label:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",required:""},{default:l(()=>[u(_,{name:"phone",mask:"+38 (###) #### ###",type:"phone",disabled:"",inputmode:"tel","left-icon":"outlined/phone","model-value":a(e).user.phone},null,8,["model-value"])]),_:1}),u(f,{label:"\u041F\u043E\u0448\u0442\u0430"},{default:l(()=>[u(_,{modelValue:a(e).user.email,"onUpdate:modelValue":t[1]||(t[1]=v=>a(e).user.email=v),name:"email",type:"email",placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043F\u043E\u0447\u0442\u0443"},null,8,["modelValue"])]),_:1}),u(f,{label:"\u0421\u043F\u0435\u0446\u0456\u0430\u043B\u0456\u0437\u0430\u0446\u0456\u044F"},{default:l(()=>[u(_,{modelValue:a(e).specialization,"onUpdate:modelValue":t[2]||(t[2]=v=>a(e).specialization=v),name:"specialization",placeholder:"\u041F\u0440\u043E\u0444\u0456\u043B\u044C \u0441\u043F\u0435\u0446\u0456\u0430\u043B\u0456\u0441\u0442\u0430"},null,8,["modelValue"])]),_:1}),u(f,{label:"\u041E\u043F\u0438\u0441"},{default:l(()=>[u(_,{modelValue:a(e).description,"onUpdate:modelValue":t[3]||(t[3]=v=>a(e).description=v),name:"description",placeholder:"\u0414\u043E\u0431\u0430\u0432\u0442\u0435 \u043E\u043F\u0438\u0441",tag:"textarea"},null,8,["modelValue"])]),_:1}),u(uu,{class:"specialist-info-page__created-at","created-at":a(e).createdAt},null,8,["created-at"]),u(w,{tag:"UiText",size:"l",theme:"action","left-icon":"outlined/link",class:"specialist-info-page__widget",onClick:I(E,["prevent"])},{default:l(()=>[su]),_:1},8,["onClick"]),u($,{class:"specialist-info-page__button",size:"l",type:"submit",theme:"blue",loading:g.value},{default:l(()=>[iu]),_:1},8,["loading"])],40,au)])}}});export{hu as default};
