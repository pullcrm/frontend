var $=Object.defineProperty;var V=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var _=(l,o,a)=>o in l?$(l,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[o]=a,n=(l,o)=>{for(var a in o||(o={}))x.call(o,a)&&_(l,a,o[a]);if(V)for(var a of V(o))R.call(o,a)&&_(l,a,o[a]);return l};import{a4 as q,bw as M,bD as N,r as T,k as y,as as L,aG as f,ay as F,U as W,b1 as i,X as z,a2 as s,x as r,W as G,I as O,V as X,a1 as j,D as H,bp as J}from"./index.90ead00b.js";import{u as K}from"./quasar.esm.prod.c88b943c.js";import{u as Q}from"./toasts.5fba8d07.js";import{V as D,a as Y,b,c as Z,u as u4}from"./index.a16d5f6b.js";import{_ as e4}from"./Layout.450cccb5.js";import{api as U}from"./api.9988d825.js";import"./logo.0179c6cf.js";import"./base.bf638541.js";import"./_commonjsHelpers.2cf1d77b.js";const c4=q({setup(l){K({title:"\u0412\u0456\u0434\u043D\u043E\u0432\u043B\u0435\u043D\u043D\u044F \u043F\u0430\u0440\u043E\u043B\u044E - pullcrm"});const o=M(),a=N(),k=Q(),e=T({code:"",phone:"",password:"",repeatPassword:""}),p=y(!1),d=y(!1),P={phone:n(n({},D("\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0443")),Y("\u041D\u0435 \u0432\u0456\u0440\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u043D\u043E\u043C\u0435\u0440\u0443")),code:d.value&&n(n({},b("\u041A\u043E\u0434 \u043C\u0430\u0454 \u0441\u043A\u043B\u0430\u0434\u0430\u0442\u0438\u0441\u044F \u0437 4-\u0445 \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432",4)),D("\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043A\u043E\u0434 \u043F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043D\u043D\u044F")),password:n(n({},b("\u041C\u0456\u043D\u0456\u043C\u0430\u043B\u044C\u043D\u0430 \u043A\u0456\u043B\u044C\u043A\u0456\u0441\u0442\u044C \u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432: 4",4)),D("\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043D\u043E\u0432\u0438\u0439 \u043F\u0430\u0440\u043E\u043B\u044C")),repeatPassword:n(n({},D("\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E \u043D\u043E\u0432\u0438\u0439 \u043F\u0430\u0440\u043E\u043B\u044C")),Z("\u041F\u0430\u0440\u043E\u043B\u0456 \u043D\u0435 \u0441\u043F\u0456\u0432\u043F\u0430\u0434\u0430\u044E\u0442\u044C",e.password))},w=u4(P,e);L(()=>{const{phone:c}=o.query;c&&(e.phone=String(c))});async function g(){if(!!await w.$validate())try{p.value=!0,await U.auth.restore({code:e.code,phone:e.phone,newPassword:e.password}),await k.show({title:"\u041F\u0430\u0440\u043E\u043B\u044C \u0437\u043C\u0456\u043D\u0435\u043D\u043E!"}),B()}catch(u){if([u.status===403&&{field:"code",error:"invalid"}].filter(Boolean).length>0)return;throw u}finally{p.value=!1}}async function I(){if(!!await w.$validate())try{p.value=!0,await U.users.confirmation({phone:e.phone,type:"RESET_PASSWORD"}),d.value=!0}catch(u){if([u.status===404&&{field:"phone",error:"invalid"}].filter(Boolean).length>0)return;throw u}finally{p.value=!1}}function B(){a.push({name:"login",query:n({},o.query)})}return(c,u)=>{const h=f("UiBack"),E=f("UiInput"),C=f("UiField"),A=f("UiButton"),S=f("UiFormValidator");return F(),W(e4,{title:"\u0412\u0456\u0434\u043D\u043E\u0432\u0438\u0442\u0438 \u0434\u043E\u0441\u0442\u0443\u043F","sub-title":"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0443, \u0449\u043E\u0431 \u0432\u0456\u0434\u043D\u043E\u0432\u0438\u0442\u0438 \u0434\u043E\u0441\u0442\u0443\u043F",class:"auth-page-restore"},{default:i(()=>[z("form",{onSubmit:u[4]||(u[4]=J(m=>d.value?g():I(),["prevent"]))},[s(h,{class:"auth-page-restore__back",onClick:B}),s(S,{validate:r(w)},{default:i(({resetFieldError:m,getFieldError:v})=>[s(C,{label:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",error:v("phone")},{default:i(()=>[s(E,{modelValue:r(e).phone,"onUpdate:modelValue":u[0]||(u[0]=t=>r(e).phone=t),mask:"+38 (###) #### ###",name:"phone","left-icon":"outlined/phone",inputmode:"tel",placeholder:"066",disabled:d.value,onInput:t=>m("phone")},null,8,["modelValue","disabled","onInput"])]),_:2},1032,["error"]),d.value?(F(),G(O,{key:0},[s(C,{label:"\u041A\u043E\u0434 \u0441\u043C\u0441",error:v("code")},{default:i(()=>[s(E,{modelValue:r(e).code,"onUpdate:modelValue":u[1]||(u[1]=t=>r(e).code=t),"left-icon":"outlined/chat-centered-text",placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u0421\u041C\u0421-\u043A\u043E\u0434",onInput:t=>m("code")},null,8,["modelValue","onInput"])]),_:2},1032,["error"]),s(C,{label:"\u041F\u0430\u0440\u043E\u043B\u044C",error:v("password")},{default:i(()=>[s(E,{modelValue:r(e).password,"onUpdate:modelValue":u[2]||(u[2]=t=>r(e).password=t),"left-icon":"outlined/key",name:"password",type:"password",placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043D\u043E\u0432\u0438\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",onInput:t=>m("password")},null,8,["modelValue","onInput"])]),_:2},1032,["error"]),s(C,{label:"\u041F\u043E\u0432\u0442\u043E\u0440\u0456\u0442\u044C \u043F\u0430\u0440\u043E\u043B\u044C",error:v("repeatPassword")},{default:i(()=>[s(E,{modelValue:r(e).repeatPassword,"onUpdate:modelValue":u[3]||(u[3]=t=>r(e).repeatPassword=t),"left-icon":"outlined/key",name:"repeatPassword",type:"password",placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043F\u043E\u0432\u0442\u043E\u0440\u043D\u043E \u043D\u043E\u0432\u0438\u0439 \u043F\u0430\u0440\u043E\u043B\u044C",onInput:t=>m("repeatPassword")},null,8,["modelValue","onInput"])]),_:2},1032,["error"])],64)):X("",!0),s(A,{class:"auth-page-restore__button",type:"submit",size:"l",theme:"blue",loading:p.value},{default:i(()=>[j(H(d.value?"\u0417\u043C\u0456\u043D\u0438\u0442\u0438 \u043F\u0430\u0440\u043E\u043B\u044C":"\u0412\u0456\u0434\u043D\u043E\u0432\u0438\u0442\u0438"),1)]),_:1},8,["loading"])]),_:1},8,["validate"])],32)]),_:1})}}});export{c4 as default};
