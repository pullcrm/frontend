import{u as A}from"./toasts.113f48d8.js";import{u as D,g as G}from"./procedures.f7d5b6cf.js";import{u as N}from"./specialist.8713490f.js";import{a4 as x,Q as m,aG as r,ay as c,W as U,a2 as l,b1 as i,a1 as f,D as b,I as C,aE as P,U as B,bp as V,k,X as L,x as M}from"./index.53588f62.js";import{_ as O}from"./ProcedurePreview.6281caad.js";import{api as Q}from"./api.50e126cb.js";import"./base.686dbe64.js";import"./money.dd3f296a.js";import"./time.8571a5e6.js";import"./dayjs.228bf609.js";import"./isTomorrow.a3ceb101.js";import"./_commonjsHelpers.2cf1d77b.js";const W={class:"specialist-procedures-procedures-group"},X=x({name:"ProceduresGroup",props:{group:null,procedureIds:null},emits:["update:procedure-ids"],setup(a,{emit:d}){const _=a,p=m(()=>_.procedureIds||[]);function n(e){return p.value.includes(e.id)}function v(e){const s=[...p.value];if(n(e)){s.splice(s.indexOf(e.id),1),d("update:procedure-ids",s);return}d("update:procedure-ids",[...p.value,e.id])}return(e,s)=>{const g=r("UiText");return c(),U("div",W,[l(g,{size:"m",strong:"",responsive:"",class:"specialist-procedures-procedures-group__name"},{default:i(()=>[f(b(a.group.categoryTitle),1)]),_:1}),(c(!0),U(C,null,P(a.group.procedures,t=>(c(),B(O,{key:`procedure-${t.id}`,size:"s",procedure:t,selected:n(t),selectable:"",class:"specialist-procedures-procedures-group__procedure-preview",onClick:V(S=>v(t),["prevent"])},null,8,["procedure","selected","onClick"]))),128))])}}});const j=f(" \u0421\u043F\u0438\u0441\u043E\u043A \u043F\u043E\u0441\u043B\u0443\u0433 "),q=f(" \u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u043F\u0435\u0440\u0435\u043B\u0456\u043A \u043F\u043E\u0441\u043B\u0443\u0433, \u044F\u043A\u0456 \u043D\u0430\u0434\u0430\u0454 \u0441\u043F\u0435\u0446\u0456\u0430\u043B\u0456\u0441\u0442 "),H={class:"specialist-procedures__inner"},ce=x({name:"SpecialistProcedures",props:{specialist:null},emits:["close"],setup(a,{emit:d}){const _=a,p=A(),n=D(),v=N(),e=k(!1),s=k(_.specialist.procedures.map(({id:u})=>u)),g=m(()=>n.procedures),t=m(()=>n.categories),S=m(()=>G(g.value,t.value));async function T(){try{e.value=!0;const{id:u}=_.specialist;await Q.specialist.setProcedures(u,{procedures:s.value}),await p.show({title:"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043E!"}),await v.fetch(u),d("close")}finally{e.value=!1}}return(u,o)=>{const $=r("UiTitle"),w=r("UiText"),E=r("UiButton"),F=r("UiPopup"),h=r("UiPopupBackdrop");return c(),B(h,{class:"specialist-procedures",onClose:o[2]||(o[2]=y=>u.$emit("close"))},{default:i(()=>[l(F,{class:"specialist-procedures__popup",onClose:o[1]||(o[1]=y=>u.$emit("close"))},{default:i(()=>[l($,{class:"specialist-procedures__title",size:"s"},{default:i(()=>[j]),_:1}),l(w,{class:"specialist-procedures__sub-title",size:"m"},{default:i(()=>[q]),_:1}),L("div",H,[(c(!0),U(C,null,P(M(S),(y,z)=>(c(),B(X,{key:z,"procedure-ids":s.value,"onUpdate:procedure-ids":o[0]||(o[0]=I=>s.value=I),group:y,class:"specialist-procedures__procedures-group"},null,8,["procedure-ids","group"]))),128)),l(E,{size:"m",theme:"blue",loading:e.value,class:"specialist-procedures__button",onClick:T},{default:i(()=>[f(" \u0417\u0430\u0441\u0442\u043E\u0441\u0443\u0432\u0430\u0442\u0438 ("+b(s.value.length)+") ",1)]),_:1},8,["loading"])])]),_:1})]),_:1})}}});export{ce as default};
