import{u as z}from"./quasar.esm.prod.7cf60e50.js";import{u as C}from"./popup.f1b7e5e0.js";import{u as k}from"./procedures.f7d5b6cf.js";import{a4 as P,Q as y,aG as o,ay as a,W as E,a2 as e,b1 as u,x as n,X as B,a1 as p,A as F,bp as b,U as x,D as U,b3 as T,V as S,I as $,aE as A}from"./index.53588f62.js";import{H as D,_ as N}from"./SortableList.ae0e9200.js";import{m as I}from"./time.8571a5e6.js";import{f as V}from"./money.dd3f296a.js";import{api as G}from"./api.50e126cb.js";import"./base.686dbe64.js";import"./dayjs.228bf609.js";import"./isTomorrow.a3ceb101.js";import"./_commonjsHelpers.2cf1d77b.js";const H={class:"procedures-page-header"},q=p(" \u0421\u043F\u0438\u0441\u043E\u043A \u043F\u043E\u0441\u043B\u0443\u0433 "),M={class:"procedures-page-header__actions"},j=p(" \u0414\u043E\u0434\u0430\u0442\u0438 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0456\u044E "),O=p(" \u0414\u043E\u0434\u0430\u0442\u0438 \u043F\u043E\u0441\u043B\u0443\u0433\u0443 "),L=P({name:"Header",setup(t){const r=C(),d=k(),s=y(()=>d.total);function l(){r.show("new-procedure")}function _(){r.show("new-procedure-category")}return(i,m)=>{const g=o("UiTitle"),f=o("UiNotificationBadge"),c=o("UiButton");return a(),E("div",H,[e(f,{class:"procedures-page-header__title",count:n(s)},{default:u(()=>[e(g,{size:"l",responsive:""},{default:u(()=>[q]),_:1})]),_:1},8,["count"]),B("div",M,[e(c,{size:"m",theme:"info-outlined",responsive:"",onClick:_},{default:u(()=>[j]),_:1}),e(c,{size:"m",theme:"blue",responsive:"",onClick:l},{default:u(()=>[O]),_:1})])])}}});const Q={class:"ui-grid procedures-page-placeholder"},W=p(" \u0414\u043E\u0434\u0430\u0442\u0438 \u043F\u043E\u0441\u043B\u0443\u0433\u0443 "),X=P({name:"Placeholder",props:{category:{type:Object,required:!0}},setup(t){const r=t,d=C();async function s(){await d.show({name:"new-procedure",props:{category:r.category}})}return(l,_)=>{const i=o("UiText"),m=o("UiPanel");return a(),E("div",Q,[e(m,{tag:"a",size:"s",href:"#",class:F(["procedures-page-placeholder__panel",["ui-grid-item","ui-grid-item_12","ui-grid-item_tablet_6","ui-grid-item_laptop_3"]]),onClick:b(s,["prevent"])},{default:u(()=>[e(i,{size:"m","right-icon":"outlined/plus",responsive:""},{default:u(()=>[W]),_:1})]),_:1},8,["onClick"])])}}});const J={class:"procedures-page-procedure-card__footer"},K={class:"procedures-page-procedure-card__info"},R={id:"hand",class:"procedures-page-procedure-card__hand"},Y=P({name:"ProcedureCard",props:{procedure:{type:Object,required:!0}},setup(t){const r=t,d=C();async function s(){await d.show({name:"edit-procedure",props:{procedure:r.procedure}})}return(l,_)=>{const i=o("UiText"),m=o("UiPrice"),g=o("UiIcon"),f=o("UiPanel");return a(),x(f,{tag:"a",size:"s",responsive:"",href:"#",class:"procedures-page-procedure-card",onClick:b(s,["prevent"])},{default:u(()=>[e(i,{size:"l",strong:"",responsive:"",class:"procedures-page-procedure-card__title"},{default:u(()=>[p(U(t.procedure.name),1)]),_:1}),e(i,{size:"m",responsive:"",class:"procedures-page-procedure-card__sub-title"},{default:u(()=>[p(U(t.procedure.description||"\u041E\u043F\u0438\u0441 \u0432\u0456\u0434\u0441\u0443\u0442\u043D\u0456\u0439"),1)]),_:1}),B("div",J,[B("div",K,[e(i,{size:"m",responsive:"",class:"procedures-page-procedure-card__duration"},{default:u(()=>[p(U(n(I)(t.procedure.duration)),1)]),_:1}),e(m,{size:"s",responsive:"",class:"procedures-page-procedure-card__price"},{default:u(()=>[p(U(n(V)(t.procedure.price)),1)]),_:1})]),T((a(),E("div",R,[e(g,{name:"outlined/hand-grabbing",size:"s"})])),[[n(D)]])])]),_:1},8,["onClick"])}}});const Z=P({name:"Group",props:{group:null,index:null},setup(t){const r=t,d=C(),s=k(),l=y(()=>r.group.procedures),_=y(()=>r.group.category),i=y(()=>{var c,h;return(h=(c=_.value)==null?void 0:c.id)!=null?h:0}),m=y(()=>r.group.categoryTitle);async function g(){!i.value||await d.show({name:"edit-procedure-category",props:{category:_.value}})}async function f(c){s.updateGroupByIndex({index:r.index,procedures:c});const h=c.map(({id:v},w)=>({id:v,order:w}));await G.procedures.bulk(h),await s.fetch()}return(c,h)=>{const v=o("UiTitle");return a(),E("div",{class:F(["procedures-page-group",{"procedures-page-group_has-category-id":n(i)>0}])},[e(v,{size:"s",responsive:"","right-icon":"outlined/pencil-simple",class:"procedures-page-group__title",onClick:b(g,["prevent"])},{default:u(()=>[p(U(n(m)),1)]),_:1},8,["onClick"]),n(l).length>0?(a(),x(N,{key:0,list:n(l),axis:"xy","item-class":["ui-grid-item","ui-grid-item_12","ui-grid-item_tablet_6","ui-grid-item_laptop_3"],"use-drag-handle":"",class:"ui-grid","onUpdate:list":f},{default:u(({item:w})=>[e(Y,{procedure:w},null,8,["procedure"])]),_:1},8,["list"])):(a(),x(X,{key:1,category:n(_),class:"procedures-page-group__placeholder"},null,8,["category"]))],2)}}});const ee={class:"procedures-page"},ue=p(" \u0414\u043E\u0434\u0430\u0442\u0438 \u043F\u043E\u0441\u043B\u0443\u0433\u0443 "),me=P({name:"ProceduresPage",setup(t){z({title:"\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u043E\u0441\u043B\u0443\u0433 - pullcrm"});const r=C(),d=k(),s=y(()=>d.grouped),l=y(()=>s.value.length===0);function _(){r.show("new-procedure")}return(i,m)=>{const g=o("UiButton"),f=o("UiPlaceholder"),c=o("UiContainer");return a(),E("div",ee,[e(c,null,{default:u(()=>[e(L,{class:"procedures-page__header"}),n(l)?(a(),x(f,{key:0,title:"\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u043E\u0441\u043B\u0443\u0433 \u043F\u043E\u0440\u043E\u0436\u043D\u0456\u0439",text:"\u0414\u043E\u0434\u0430\u0439\u0442\u0435 \u043F\u043E\u0441\u043B\u0443\u0433\u0443, \u0449\u043E\u0431 \u0440\u043E\u0437\u043F\u043E\u0447\u0430\u0442\u0438 \u0440\u043E\u0431\u043E\u0442\u0443",image:require("~/assets/images/procedures-empty.svg")},{default:u(()=>[e(g,{theme:"blue","right-icon":"outlined/plus",onClick:_},{default:u(()=>[ue]),_:1})]),_:1},8,["image"])):S("",!0),(a(!0),E($,null,A(n(s),(h,v)=>(a(),x(Z,{key:v,index:v,group:h,class:"procedures-page__group"},null,8,["index","group"]))),128))]),_:1})])}}});export{me as default};
