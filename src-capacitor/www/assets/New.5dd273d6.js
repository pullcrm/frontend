var $=Object.defineProperty;var C=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var N=(t,u,e)=>u in t?$(t,u,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[u]=e,p=(t,u)=>{for(var e in u||(u={}))x.call(u,e)&&N(t,e,u[e]);if(C)for(var e of C(u))P.call(u,e)&&N(t,e,u[e]);return t};import{a4 as g,k as S,Q as k,aG as i,ay as T,U as q,b1 as n,X as m,a2 as a,x as z,bp as A,a1 as D}from"./index.53588f62.js";import{u as G}from"./popup.f1b7e5e0.js";import{u as L}from"./procedures.f7d5b6cf.js";import{u as M}from"./specialists.56f430f2.js";import{V as b,b as Q,u as R}from"./index.e6dcdd48.js";import{api as X}from"./api.50e126cb.js";import"./base.686dbe64.js";import"./toasts.113f48d8.js";import"./roles.61f7d6b9.js";import"./_commonjsHelpers.2cf1d77b.js";const j={class:"popup-specialist__header"},H=D(" \u0414\u043E\u0434\u0430\u0442\u0438 \u0441\u043F\u0456\u0432\u0440\u043E\u0431\u0456\u0442\u043D\u0438\u043A\u0430 "),J=["onSubmit"],K={class:"popup-specialist__actions"},O=D(" \u0414\u043E\u0434\u0430\u0442\u0438 \u0441\u043F\u0456\u0432\u0440\u043E\u0431\u0456\u0442\u043D\u0438\u043A\u0430 "),lu=g({name:"New",emits:["close"],setup(t){const u=G(),e=L(),f=M(),s=S({fullName:"",phone:""}),c=S(!1),F={fullName:p({},b("\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u0456\u043C'\u044F \u0442\u0430 \u041F\u0440\u0456\u0437\u0432\u0438\u0449\u0435")),phone:p(p({},Q("\u041D\u0435 \u0432\u0456\u0440\u043D\u0438\u0439 \u0444\u043E\u0440\u043C\u0430\u0442 \u043D\u043E\u043C\u0435\u0440\u0443")),b("\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0443"))},_=R(F,s),E=k(()=>f.specialistsDict);async function w(){if(!!await _.$validate())try{c.value=!0;const{id:o}=await X.specialist.create(s.value);if(await f.fetch(),e.total>0){const r=E.value[o];u.show({name:"specialist-procedures",props:{specialist:r}})}}catch(o){if([o.status===400&&{field:"phone",error:"uniq"},o.fieldName==="phone"&&{field:"phone",error:"invalid"}].filter(Boolean).length>0)return;throw o}finally{c.value=!1}}return(v,o)=>{const r=i("UiTitle"),h=i("UiInput"),V=i("UiField"),y=i("UiButton"),B=i("UiFormValidator"),I=i("UiPopup");return T(),q(I,{class:"popup-specialist",onClose:o[2]||(o[2]=d=>v.$emit("close"))},{default:n(()=>[m("div",j,[a(r,{size:"s"},{default:n(()=>[H]),_:1})]),m("form",{onSubmit:A(w,["prevent"])},[a(B,{validate:z(_)},{default:n(({resetFieldError:d,getFieldError:U})=>[a(V,{label:"\u0406\u043C'\u044F \u0442\u0430 \u041F\u0440\u0456\u0437\u0432\u0438\u0449\u0435",error:U("fullName")},{default:n(()=>[a(h,{modelValue:s.value.fullName,"onUpdate:modelValue":o[0]||(o[0]=l=>s.value.fullName=l),name:"name",placeholder:"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u0406\u043C'\u044F \u0442\u0430 \u041F\u0440\u0456\u0437\u0432\u0438\u0449\u0435",onInput:l=>d("fullName")},null,8,["modelValue","onInput"])]),_:2},1032,["error"]),a(V,{label:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",error:U("phone")},{default:n(()=>[a(h,{modelValue:s.value.phone,"onUpdate:modelValue":o[1]||(o[1]=l=>s.value.phone=l),mask:"+38 (###) #### ###",name:"phone",type:"phone",inputmode:"tel","left-icon":"outlined/phone",placeholder:"066",onInput:l=>d("phone")},null,8,["modelValue","onInput"])]),_:2},1032,["error"]),m("div",K,[a(y,{size:"l",type:"submit",theme:"blue",loading:c.value},{default:n(()=>[O]),_:1},8,["loading"])])]),_:1},8,["validate"])],40,J)]),_:1})}}});export{lu as default};
