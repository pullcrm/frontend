import{a as C,u as F,b as U}from"./base.bf638541.js";import{u as V}from"./quasar.esm.prod.c88b943c.js";import{br as v,bw as D,bD as w,k as h,Q as _,as as B,aG as s,ay as E,U as k,b1 as c,X as S,V as A,a2 as t,bp as g,a1 as q}from"./index.90ead00b.js";import{api as P}from"./api.9988d825.js";import{_ as T}from"./Layout.450cccb5.js";import"./_commonjsHelpers.2cf1d77b.js";import"./logo.0179c6cf.js";const x={components:{Layout:T},async preFetch(){const a=C();await Promise.all([a.fetchCompanyTypes,a.fetchCities])},setup(){V({title:"\u041D\u043E\u0432\u0430 \u043A\u043E\u043C\u043F\u0430\u043D\u0456\u044F - pullcrm"});const a=D(),o=w(),b=F(),u=C(),d=U(),n=h({name:"",city:null,type:null}),i=h(!1);_(()=>u.cities);const m=_(()=>u.companyTypes),l=_(()=>d.hasPositions);B(()=>{const e=m.value.find(({id:r})=>r===Number(a.query.companyType));e&&(n.value.type=e)});async function p(){try{i.value=!0;const{id:e}=await P.companies.create({name:n.value.name,cityId:n.value.city.id,typeId:n.value.type.id});await y(e);const{href:r}=o.resolve({name:"dashboard"});window.location.href=r}finally{i.value=!1}}async function y(e){await u.fetchProfile();const r=d.positionsDict[e];await b.refreshTokenByPosition(r)}async function f(){await o.push({name:"dashboard"})}return{submit:p,hasPositions:l,onBack:f,company:n,companyTypes:m,isLoading:i}}},I=q(" \u041F\u0440\u043E\u0434\u043E\u0432\u0436\u0438\u0442\u0438 ");function L(a,o,b,u,d,n){const i=s("UiBack"),m=s("UiInput"),l=s("UiField"),p=s("UiSelect"),y=s("UiButton"),f=s("Layout");return E(),k(f,{title:"\u0421\u0442\u0432\u043E\u0440\u0435\u043D\u043D\u044F \u043A\u043E\u043C\u043F\u0430\u043D\u0456\u0457","sub-title":"\u0412\u043A\u0430\u0436\u0456\u0442\u044C \u0456\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0456\u044E \u043F\u0440\u043E \u043A\u043E\u043C\u043F\u0430\u043D\u0456\u044E",class:"auth-page-company-create"},{default:c(()=>[S("form",{onSubmit:o[3]||(o[3]=g((...e)=>u.submit&&u.submit(...e),["prevent"]))},[u.hasPositions?(E(),k(i,{key:0,class:"auth-page-company-create__back",onClick:u.onBack},null,8,["onClick"])):A("",!0),t(l,{label:"\u041D\u0430\u0437\u0432\u0430 \u043A\u043E\u043C\u043F\u0430\u043D\u0456\u0457",required:""},{default:c(()=>[t(m,{modelValue:u.company.name,"onUpdate:modelValue":o[0]||(o[0]=e=>u.company.name=e),"left-icon":"outlined/pencil",placeholder:"\u0412\u0430\u0448\u0430 \u043A\u043E\u043C\u043F\u0430\u043D\u0456\u044F",required:""},null,8,["modelValue"])]),_:1}),t(l,{label:"\u041C\u0456\u0441\u0442\u043E",required:""},{default:c(()=>[t(p,{modelValue:u.company.city,"onUpdate:modelValue":o[1]||(o[1]=e=>u.company.city=e),required:"",options:a.cities,"label-key":"name",placeholder:"\u0412\u0438\u0431\u0440\u0430\u0442\u0438 \u043C\u0456\u0441\u0442\u043E"},null,8,["modelValue","options"])]),_:1}),t(l,{label:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0456\u044F",required:""},{default:c(()=>[t(p,{modelValue:u.company.type,"onUpdate:modelValue":o[2]||(o[2]=e=>u.company.type=e),"label-key":"name",placeholder:"\u0412\u0438\u0431\u0440\u0430\u0442\u0438 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0456\u044E",options:u.companyTypes,required:""},null,8,["modelValue","options"])]),_:1}),t(y,{class:"auth-page-company-create__button",type:"submit",size:"l",theme:"blue",loading:u.isLoading},{default:c(()=>[I]),_:1},8,["loading"])],32)]),_:1})}var j=v(x,[["render",L]]);export{j as default};
