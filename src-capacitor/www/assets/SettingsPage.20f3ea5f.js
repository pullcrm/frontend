import{a4 as W,bD as X,k,Q as u,aG as l,ay as f,W as C,X as $,a2 as a,b1 as i,x as t,f as U,U as H,V,I as J,bp as K,a1 as S}from"./index.53588f62.js";import{u as Y,b as Z}from"./base.686dbe64.js";import{u as uu}from"./popup.f1b7e5e0.js";import{u as eu}from"./toasts.113f48d8.js";import{u as tu}from"./specialist.8713490f.js";import{u as su,r as v,s as A}from"./specialists.56f430f2.js";import{api as I}from"./api.50e126cb.js";import{S as b,M as au,A as ou}from"./roles.61f7d6b9.js";import"./_commonjsHelpers.2cf1d77b.js";const iu={class:"specialist-settings-page"},nu=["onSubmit"],lu=S(" \u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438 "),ru=S(" \u0412\u0438\u0439\u0442\u0438 "),cu=S(" \u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438 \u0441\u043F\u0456\u0432\u0440\u043E\u0431\u0456\u0442\u043D\u0438\u043A\u0430 "),yu=W({name:"SettingsPage",setup(du){const g=X(),R=Y(),h=uu(),y=eu(),D=Z(),x=tu(),B=su(),s=k(x.specialist),n=u(()=>v[s.value.role.name]),r=k(!1),c=u({get(){return A[s.value.status]},set(o){s.value.status=o.name}}),N=u(()=>Object.values(A)),d=u(()=>D.role),P=u(()=>d.value.name===b),p=u(()=>s.value.id),M=u(()=>[v[au],v[b]]),T=u(()=>D.currentId),w=u(()=>p.value===T.value),q=u(()=>d.value.name===ou&&w.value===!1),L=u(()=>d.value.name===b);async function z(){try{r.value=!0,await I.specialist.update({id:s.value.id,role:n.value.value,status:s.value.status}),y.show({title:"\u0417\u0431\u0435\u0440\u0435\u0436\u0435\u043D\u043E!"}),j()}catch(o){y.show({title:`\u041F\u043E\u043C\u0438\u043B\u043A\u0430: ${o.data.message}`,type:"error"})}finally{r.value=!1}}async function Q(){if(await h.askQuestion({title:"\u0412\u0438 \u0434\u0456\u0439\u0441\u043D\u043E \u0431\u0430\u0436\u0430\u0454\u0442\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u0438 \u0441\u0435\u0430\u043D\u0441?",acceptButtonTitle:"\u0412\u0438\u0439\u0442\u0438"})){await R.logout();const{href:e}=g.resolve({name:"login"});window.location.href=e}}async function G(){if(await h.askQuestion({title:"\u0412\u0438 \u0434\u0456\u0439\u0441\u043D\u043E \u0431\u0430\u0436\u0430\u0454\u0442\u0435 \u0432\u0438\u0434\u0430\u043B\u0438\u0442\u0438 \u043F\u0440\u043E\u0444\u0456\u043B\u044C \u0441\u043F\u0456\u0432\u0440\u043E\u0431\u0456\u0442\u043D\u0438\u043A\u0430? \u0426\u044F \u0434\u0456\u044F \u043D\u0435 \u0437\u0432\u043E\u0440\u043E\u0442\u043D\u044F!",acceptButtonTitle:"\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438!"})){await I.specialist.remove(p.value);const{href:e}=g.resolve({name:"specialists"});window.location.href=e}}async function j(){await B.fetch(),s.value=B.byId(p.value)}return(o,e)=>{const E=l("UiSelect"),F=l("UiField"),m=l("UiButton"),O=l("UiDivider");return f(),C("div",iu,[$("form",{onSubmit:K(z,["prevent"])},[a(F,{label:"\u0414\u043E\u0441\u0442\u0443\u043F\u043D\u0456\u0441\u0442\u044C \u0434\u043B\u044F \u0437\u0430\u043F\u0438\u0441\u0443",required:""},{default:i(()=>[a(E,{modelValue:t(c),"onUpdate:modelValue":e[0]||(e[0]=_=>U(c)?c.value=_:null),options:t(N),"label-key":"value",required:"",disabled:t(P)},null,8,["modelValue","options","disabled"])]),_:1}),a(F,{label:"\u0420\u043E\u043B\u044C",required:""},{default:i(()=>[a(E,{modelValue:t(n),"onUpdate:modelValue":e[1]||(e[1]=_=>U(n)?n.value=_:null),options:t(M),"label-key":"name",disabled:t(L),required:""},null,8,["modelValue","options","disabled"])]),_:1}),a(m,{class:"specialist-settings-page__button",size:"l",type:"submit",theme:"blue",loading:r.value},{default:i(()=>[lu]),_:1},8,["loading"]),t(w)?(f(),H(m,{key:0,class:"specialist-settings-page__button",size:"l",theme:"danger-outlined",onClick:Q},{default:i(()=>[ru]),_:1})):V("",!0),t(q)?(f(),C(J,{key:1},[a(O),a(m,{class:"specialist-settings-page__button",size:"l",theme:"danger-outlined",onClick:G},{default:i(()=>[cu]),_:1})],64)):V("",!0)],40,nu)])}}});export{yu as default};
